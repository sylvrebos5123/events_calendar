<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="robots" content="noindex, nofollow">
  <meta name="googlebot" content="noindex, nofollow">


	<link href='../fullcalendar.css' rel='stylesheet' />
	<link href='../fullcalendar.print.css' rel='stylesheet' media='print' />
	<script src='../lib/moment.min.js'></script>
	<script src='../lib/jquery.min.js'></script>
	<script src='../fullcalendar.min.js'></script>
	<link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
  <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
  <style type="text/css">
  
	body {
		margin: 40px 10px;
		padding: 0;
		font-family: "Lucida Grande",Helvetica,Arial,Verdana,sans-serif;
		font-size: 14px;
	}
	
    #calendar {
		max-width: 900px;
		margin: 0 auto;
	}


  </style>

  <title>Bootstrap and Fullcalendar module by SV</title>


<script type='text/javascript'>//<![CDATA[
$(window).load(function(){
$(document).ready(function() {

	 $('#calendar').fullCalendar({
      defaultView: 'agendaWeek',
        timezone: 'UTC',
        editable: false,
        selectable: true,
        timeFormat: 'H:mm',
		events: {

		url: 'php/file_test.php',
			error: function() {
				$('#script-warning').show();
			}
		},
      //header and other values
      select: function(start, end, allDay) {

		starttime=moment(start).format('YYYY-MM-DDTHH:mm:ss'); 
        endtime=moment(end).format('YYYY-MM-DDTHH:mm:ss'); 
          //var mywhen = starttime + ' - ' + endtime;
          var split_starttime=starttime.split('T');
          var split_endtime=endtime.split('T');


          var split_starttime=starttime.split('T');

          $('#createEventModal #start_date').val(split_starttime[0]);
          $('#createEventModal #start_time').val(split_starttime[1]);
          $('#createEventModal #end_date').val(split_endtime[0]);
          $('#createEventModal #end_time').val(split_endtime[1]);

          $('#createEventModal #apptAllDay').val(allDay);
          $('#createEventModal').modal('show');
       }
    });

  $('#submitButton').on('click', function(e){
    // We don't want this to act as a link so cancel the link action
    e.preventDefault();

    doSubmit();
  });

  function doSubmit(){
    $("#createEventModal").modal('hide');

    if($('#start_time').val()=='00:00:00')
    {

        startDateTime = moment($('#start_date').val()).format('YYYY-MM-DD');
    }
    else
    {
        startDateTime = moment($('#start_date').val()+' '+$('#start_time').val()).format('YYYY-MM-DDTHH:mm:ss');
    }
////////
    if($('#end_time').val()=='00:00:00')
    {
      endDateTime = moment($('#end_date').val()).format('YYYY-MM-DD');
    }
    else
    {
      endDateTime = moment($('#end_date').val() + ' ' + $('#end_time').val()).format('YYYY-MM-DDTHH:mm:ss');
    }

    //alert(startDateTime);
    //alert(endDateTime);

      $.ajax({
              method: "POST",
              url: "php/add_event.php",
              data: {
                  event_title: $('#event_title').val(),
                  event_place: $('#event_place').val(),
                  start_date_time: startDateTime,
                  end_date_time: endDateTime
              }
          })
          .done(function( msg ) {
              alert( "Data Saved: " + msg );
          });
    $("#calendar").fullCalendar('renderEvent',
        {
            title: $('#event_title').val()+' - '+$('#event_place').val(),
            start: startDateTime,
            end: endDateTime,
            allDay: ($('#apptAllDay').val() == "true")
        },
        true);
   }
});
});

</script>

  
</head>

<body>
  <div id="calendar"></div>

  
<div class="modal fade" id="createEventModal" role="dialog">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title">Create Event</h4>
        </div>
        <div class="modal-body">
          <!-- form -->
		  <form id="createAppointmentForm" class="form-horizontal" action="php/add_event.php" method="post">
              <div class="form-group row">
                <input type="hidden" id="apptAllDay" />
                <label class="col-sm-2" for="inputevent_title">Title:</label>
                <div class="col-sm-10">
                    <input type="text" name="event_title" id="event_title" class="form-control">
                </div>
              </div>
              <div class="form-group row">
                <label class="col-sm-2" for="inputevent_place">Place:</label>
                <div class="col-sm-10">
                    <input type="text" name="event_place" id="event_place" class="form-control">
                </div>
              </div>
              <div class="form-group">

                <label class="col-sm-2" for="when">When:</label>
                <div class="col-sm-3">
                    <input type="date"  id="start_date" name="start_date" value="" class="form-control">
                </div>
                <div class="col-sm-2">
                    <input type="time" id="start_time" name="start_time" class="form-control">
                </div>
              <br></br>

                    <div class="col-sm-offset-2 col-sm-3">
                        <input type="date" id="end_date" name="end_date" class="form-control">
                    </div>
                    <div class="col-sm-2">
                        <input type="time" id="end_time" name="end_time" class="form-control">
                    </div>

			</div>
		</form>
		 <!-- form -->
        </div>
        <div class="modal-footer">
		  <button class="btn btn-default" data-dismiss="modal" >Cancel</button>
          <button type="submit" class="btn btn-primary" id="submitButton">Save</button>
        </div>
      </div>
    </div>
</div>

  
</body>

</html>

